<!-- DevelopingProjects.html -->
<!-- Created by Carol Clark on 12/17/11 for project Support. -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>DevelopingProjects</title>
	<link rel="stylesheet" type="text/css" href="../css/technical.css" />	
</head>
<body>
<div class='navhead' id='Top'><table class='navhead'><col class='navhead_c1' /><tr> <td>[<a href="../Support/Support.html">Support</a>]</td> <td >[<a href="History_Support.html#Contents">History</a>]</td><td class='right'>[<a href="#Contents">Contents</a>]</td></tr></table></div>
<h1>Developing Projects</h1>

<!-- @topicList "DevelopingProjects" "Contents" -->
	<!-- @topicItem "Projects" "#Projects_" "0" "" -->
	<!-- @topicItem "Targets and Build Phases" "#Target_" "0" "" -->
	<!-- @topicItem "Interface Builder" "#InterfaceBuilder" "0" "" -->
	<!-- @topicItem "Porting C++ to Objective-C" "#PortingCxxToObjC" "0" "" -->
<!-- @/topicList -->

<p>tasks and refactorings related to development with Xcode projects</p>

<!-- @marker "Projects" -->
<h2>Projects</h2>

<!-- @topicList "Projects" "Projects_" -->
	<!-- @topicItem "Add Cocoa Project" "#AddCocoaProject" "0" "" -->
<!-- @/topicList -->

<!-- @marker "Add Cocoa Project" -->
<h4 id='AddCocoaProject'>Add Cocoa Project</h4><ul>
	<li>open the Workspace that will contain the Project</li>
	<li>create Project from indicated template; check Include Unit Tests</li>
	<li>mark schemes "shared"</li>
	<li><a href="#AddUnitTesting">Add Unit Testing</a></li>
	<li><a href="#AddDoxygenTarget">Add Doxygen Target</a></li>
</ul>

<!-- @marker "Targets and Build Phases" -->
<h2>Targets and Build Phases</h2>

<!-- @topicList "Targets and Build Phases" "Target_" -->
	<!-- @topicItem "Add Run Script Target" "#AddRunScriptTarget" "0" "" -->
	<!-- @topicItem "Promote Build Phase to Target" "#PromoteRunPhaseToTarget" "0" "" -->
	<!-- @topicItem "Add Unit Testing" "#AddUnitTesting" "0" "" -->
	<!-- @topicItem "Add Doxygen Target" "#AddDoxygenTarget" "0" "" -->
<!-- @/topicList -->

<!-- @marker "Add Run Script Target" -->
<h4 id='AddRunScriptTarget'>Add Run Script Target</h4><ul>
	<li>create new Bundle target<ul>
		<li>mark scheme as shared</li>
		<li>delete files *.pch, InfoPlist.strings from target's SupportingFiles group</li>
		<li>remove build phases Compile Sources, Link Binary with Libraries, Copy Bundle resources</li>
		<li>add Run Script build phase</li>
	</ul></li>
</ul>

<!-- @marker "Promote Run Phase to Target" -->
<h4 id='PromoteRunPhaseToTarget'>Promote Run Phase to Target</h4><ul class='blurb'>
		<li>make a Run Script build phase into its own target</li>
		<li>use to separately control the steps in building a product</li>
	</ul><ul>
		<li><a href="#AddRunScriptTarget">Add Run Script Target</a></li>
		<li>copy script from its build phase in the old target to the new Run Script phase in the new target</li>
		<li>in the original target's scheme, add the new target to the target list of the Build section</li>
		<li>test build</li>
		<li>in the original target, remove the Run Script build phase that has been replaced</li>
	</ul>

<!-- @marker "Add Unit Testing" -->
<h4 id='AddUnitTesting'>Add Unit Testing</h4><ul>
	<li>add Application Tests<ul>
		<li class='blurb'>We have only produced application test targets by requesting them with the template when the target is first produced.</li>
		<li class='blurb'>from iPhoneUnitsSample ReadMe: "Important: Application targets with unit tests cannot be built or run using the iPhone Simulator SDK; they can be built and run only using the iPhone Device SDK." The sample produces two copies of the app, one with Unit Tests and one without.</li>
	</ul></li>
	<li>add Unit Tests<ul>
		<li>add a new target from Cocoa Unit Testing Bundle template</li>
		<li>mark scheme "shared"</li>
	</ul></li>
	<li>set up debugging<ul>
		<li>add symbolic breakpoint at -[SenTestCase failWithException:]</li>
	</ul></li>
</ul>
	
<!-- @marker "Add Doxygen Target" -->
<h4 id='AddDoxygenTarget'>Add Doxygen Target</h4><ul>
	<li>add Run Script build phase or <a href="#AddRunScriptTarget">target</a>: doxygenBuild &lt;ProjectName&gt;</li>
	<li>add file &lt;Project&gt;.doxygen from template; set parameters as indicated, using Dev/Support/Default.doxygen as a reference</li>
</ul>

<!-- @marker "Interface Builder" -->
<h2>Interface Builder</h2>
<!-- @topicList "Interface Builder" "InterfaceBuilder" -->
	<!-- @topicItem "Remove IB Outlet" "#RemoveIBOutlet" "0" "" -->
	<!-- @topicItem "Rename IB Outlet" "#RenameIBOutlet" "0" "" -->
	<!-- @topicItem "Rename IB Object" "#RenameIBObject" "0" "" -->
<!-- @/topicList -->

<!-- @marker "Remove IB Outlet" -->
<h4 id='RemoveIBOutlet'>Remove IB Outlet</h4><ul>
	<li>ensure that the IBOutlet variable is not accessed in code</li>
	<li>in Interface Builder, delete the outlet connection</li>
	<li>remove all occurrences of the IBOutlet variable in code</li>
</ul>

<!-- @marker "Rename IB Outlet" -->
<h4 id='RenameIBOutlet'>Rename IB Outlet</h4><ul>
	<li>add outlet connection for new name</li>
	<li>compare the properties of the variables with the old and new names; make new variable match original intent</li>
	<li>change all uses of the original variable to use the new name</li>
	<li>apply <a href="#RemoveIBOutlet">Remove IB Outlet</a> to the original variable name</li>
</ul>

<!-- @marker "Rename IB Object" -->
<h4 id='RenameIBObject'>Rename IB Object</h4><ul>
	<li>in Interface Builder's hierarchical list, rename the object</li>
	<li>apply <a href="#RenameIBOutlet">Rename IB Outlet</a> as indicated to rename IBOutlet connections to the renamed object</li>
</ul>

<!-- @marker "Porting C++ to Objective-C" -->
<h2>Porting C++ to Objective-C</h2><ul>
	<li>Motivation<ul>
		<li>For Mac development, C++ is being replaced by Cocoa with Objective-C.</li>
		<li>Xcode supports and we consistently use a testing framework for Objective-C, but not for C++.</li>
		<li>C++ code is incompatible with Objective-C Automatic Reference Counting.</li>
	</ul></li>
	<li>AccessorC9<ul>
		<li>These techniques are intended for use in porting C++ code from AccessorC9 to its Cocoa version Accessor. We exploit some characteristics of AccessorC9 in this process.<ul>
			<li>AccessorC9 code is contained in namespace AccessLib, alias <span class='mono'>al</span>. ObjC objects &lt;Class&gt; are used to wrap C++ objects &lt;al::Class&gt;.</li>
			<li>AccessorC9 class al::Host was intended to support polymorphism for executable type and context. al::Host became bottleneck access point to the Application, Window, and SlateManager classes. We now exploit those aspects to provide an initial facade between Objective-C and C++ code.</li>
		</ul></li>
	</ul></li>
	<li>As much as possible, we will wrap rather than change existing code until the initial import is complete.</li>
</ul>

<!-- @topicList "Porting C++ to Objective-C" "PortingCxxToObjC" -->
	<!-- @topicItem "Wrap C++ Class with Objective-C" "#WrapCxxClassWithObjC" "0" "" -->
	<!-- @topicItem "Add C++ Object to Objective-C Class" "#AddCxxObjectToObjCClass" "0" "" -->
	<!-- @topicItem "Replace C++ Interface with Objective-C" "#ReplaceCxxInterfaceWithObjC" "0" "deprecated" -->
	<!-- @topicItem "Use Objective-C Feature Interface" "#UseObjCFeatureInterface" "0" "deprecated9" -->	
<!-- @/topicList -->

<!-- @marker "Wrap C++ Class with Objective-C" -->
<h4 id='WrapCxxClassWithObjC'>Wrap C++ Class with Objective-C</h4><ul>
	<li>add files &lt;Class&gt;_AL.cp/h to project, file &lt;Class&gt;_AL.cp to target; compile and test</li>
	<li>add files &lt;Class&gt;.mm/h, &lt;Class&gt;Test.mm/h to project and relevant targets; compile and test</li>
	<li>apply [<a href="#AddCxxObjectToObjCClass">Add C++ Object to Objective-C Class</a>] to add C++ object of type al::&lt;Class&gt; to &lt;Class&gt;; add init... and destroy code; compile and test</li>
</ul>
	
<!-- @marker "Add C++ Object to Objective-C Class" -->
<h4 id='AddCxxObjectToObjCClass'>Add C++ Object to Objective-C Class</h4><ul>
	<li>&lt;Class&gt;: see <a href="http://robnapier.net/blog/wrapping-c-take-2-1-486">Wrapping C++</a></li>	
</ul>

<div class='depr'>
<!-- @marker "Replace C++ Interface with Objective-C" -->
<h4 id='ReplaceCxxInterfaceWithObjC'>Replace C++ Interface with Objective-C</h4><ul>
	<li class='blurb'>ultimately replaces C++ module &lt;Module&gt;_XX.cp/h with Objective-C module &lt;Module&gt;_YY.mm/h</li>
	<li class='blurb'>we use "provide" here in the sense of "create if it does not already exist"</li>
	<li>provide Objective-C files &lt;Module&gt;_YY/mm.h to contain wrappers for the C++ classes in &lt;Module&gt;_XX.cp/h</li>
	<li>provide test files &lt;Module&gt;Test_YY/mm.h</li>
	<li>for each class in &lt;Module&gt;_XX.cp/h<ul>
		<li>rename C++ &lt;Class&gt; to &lt;Class_CP&gt;</li>
		<li>in &lt;Module&gt;_YY/mm.h, provide wrapper &lt;Class&gt; to access code in &lt;Class_CP&gt;</li>
		<li>for each feature<ul>
			<li>define method(s) in &lt;Module&gt;_YY/mm.h:&lt;Class&gt; to access the C++ code to be tested</li>
			<li>add tests for &lt;Module&gt;_YY/mm.h</li>
		</ul></li>
	</ul></li>
	<li>replace C++ interface with Objective-C interface<ul>
		<li>for each feature in existing module: <a href="#UseObjCFeatureInterface">Use Objective-C Feature Interface</a></li>
		<li>verify that file &lt;Module&gt;_XX.h is not referenced except from &lt;Module&gt;_YY.h</li>
	</ul></li>
	<li>for each feature: move implementation code from C++ files to Objective-C files</li>
	<li>remove C++ files for this module</li>
</ul>
	
<!-- @marker "Use Objective-C Feature Interface" -->
<h4 id='UseObjCFeatureInterface'>Use Objective-C Feature Interface</h4><ul>
</ul>
</div>

<p><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></p>
<hr class='footer' />
<p class='footer'>Copyright 2011-12 C &amp; C Software, Inc. All rights reserved.</p>
<p class='footer'>Confidential and Proprietary.</p>
</body>
</html>
